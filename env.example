# AWS Generic Logs Fetcher Environment Variables
# Copy this file to .env and update with your actual values

# =============================================================================
# AWS CREDENTIALS & AUTHENTICATION
# =============================================================================

# AWS Access Key ID (required)
AWS_ACCESS_KEY=AKIAIOSFODNN7EXAMPLE

# AWS Secret Access Key (required)
AWS_SECRET_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# AWS Role ARN to assume (required for cross-account access)
AWS_ROLE_ARN=arn:aws:iam::123456789012:role/LogFetcherRole

# AWS Region for API calls (default: ap-south-1)
AWS_REGION=ap-south-1

# AWS Account ID (default: 611780053365)
AWS_ACCOUNT_ID=123456789012

# AWS Organization ID (required for CloudTrail organization logs)
AWS_ORGANIZATION_ID=o-xxxxxxxxx

# =============================================================================
# S3 BUCKET CONFIGURATION
# =============================================================================

# S3 Bucket name (required)
S3_BUCKET_NAME=your-logs-bucket

# S3 Prefix for service logs (default: "")
S3_PREFIX=msmlogs/

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================

# AWS Service to fetch logs for (required)
# Options: cloudtrail, vpcflow, config, kms, macie, trusted-advisor, 
#          guardduty, waf, server_access, alb, clb, nlb, cisco_umbrella
AWS_SERVICE=cloudtrail

# Specific AWS regions to process (default: auto-discover)
# Leave empty for auto-discovery, or specify regions like: us-east-1,us-west-2
AWS_REGIONS=

# =============================================================================
# OUTPUT & LOGGING CONFIGURATION
# =============================================================================

# Output file path (default: aws_logs_output.json)
OUTPUT_FILE=aws_logs_output.json

# Log file path (default: aws_logs.log)
LOG_FILE=aws_logs.log

# Log level (default: INFO)
# Options: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# =============================================================================
# OPERATIONAL SETTINGS
# =============================================================================

# Run mode (default: continuous)
# Options: once, continuous
RUN_MODE=continuous

# Interval between log fetching runs in seconds (default: 60)
FETCH_INTERVAL=300

# Minutes to look back for logs when no state exists (default: 60)
LOOKBACK_MINUTES=60

# Starting time for log collection (ISO format, e.g. 2025-03-07T10:00:00Z)
# Leave empty to use default lookback time
START_TIME=

# =============================================================================
# SERVICE-SPECIFIC CONFIGURATIONS
# =============================================================================

# CloudTrail Configuration
CLOUDTRAIL_PREFIX=msmlogs/
CLOUDTRAIL_ORGANIZATION_ID=o-xxxxxxxxx

# ALB/CLB Configuration
ALB_PREFIX=alb-logs/
ALB_ACCOUNT_ID=123456789012

# VPC Flow Logs Configuration
VPC_PREFIX=vpc-logs/
VPC_ACCOUNT_ID=123456789012

# AWS Config Configuration
CONFIG_PREFIX=config-logs/
CONFIG_ACCOUNT_ID=123456789012

# GuardDuty Configuration
GUARDDUTY_PREFIX=security-logs/
GUARDDUTY_ACCOUNT_ID=123456789012

# WAF Configuration
WAF_PREFIX=waf-logs/
WAF_ACCOUNT_ID=123456789012

# S3 Server Access Configuration
S3_ACCESS_PREFIX=s3-access-logs/

# KMS Configuration
KMS_PREFIX=kms-logs/

# Macie Configuration
MACIE_PREFIX=macie-logs/

# Trusted Advisor Configuration
TRUSTED_ADVISOR_PREFIX=trusted-advisor-logs/

# NLB Configuration
NLB_PREFIX=nlb-logs/

# Cisco Umbrella Configuration
CISCO_UMBRELLA_PREFIX=umbrella-logs/

# =============================================================================
# ADVANCED SETTINGS
# =============================================================================

# Credential refresh interval in seconds (default: 3300 = 55 minutes)
CREDENTIAL_REFRESH_INTERVAL=3300

# Maximum number of S3 objects to process per batch (default: 1000)
S3_BATCH_SIZE=1000

# Enable debug mode (default: false)
DEBUG_MODE=false

# Enable dry run mode (list files without processing)
DRY_RUN=false

# =============================================================================
# INTEGRATION SETTINGS
# =============================================================================

# Wazuh Integration
# Enable Wazuh-compatible output format
WAZUH_INTEGRATION=false

# Wazuh server URL (if using direct integration)
WAZUH_SERVER_URL=http://wazuh-server:55000

# Wazuh API credentials
WAZUH_USERNAME=wazuh_user
WAZUH_PASSWORD=wazuh_password

# =============================================================================
# MONITORING & ALERTING
# =============================================================================

# Enable health check endpoint (default: false)
HEALTH_CHECK_ENABLED=false

# Health check port (default: 8080)
HEALTH_CHECK_PORT=8080

# Metrics collection interval in seconds (default: 60)
METRICS_INTERVAL=60

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Enable SSL/TLS for API calls (default: true)
SSL_VERIFY=true

# Custom CA certificate path (if needed)
CA_CERT_PATH=

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Number of concurrent S3 operations (default: 10)
S3_CONCURRENT_OPS=10

# S3 request timeout in seconds (default: 60)
S3_TIMEOUT=60

# Memory limit for processing large files in MB (default: 512)
MEMORY_LIMIT_MB=512

# =============================================================================
# BACKUP & RETENTION
# =============================================================================

# Enable automatic backup of state file (default: true)
BACKUP_STATE=true

# Backup retention days (default: 30)
BACKUP_RETENTION_DAYS=30

# Backup directory (default: ./backups)
BACKUP_DIR=./backups

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Enable email notifications (default: false)
EMAIL_NOTIFICATIONS=false

# SMTP server configuration
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Notification recipients (comma-separated)
NOTIFICATION_RECIPIENTS=admin@example.com,security@example.com

# =============================================================================
# EXAMPLE USAGE
# =============================================================================

# To use this configuration:
# 1. Copy this file to .env
# 2. Update the values with your actual configuration
# 3. Run the script with: python aws-logs-generic.py

# Example for CloudTrail monitoring:
# AWS_SERVICE=cloudtrail
# S3_BUCKET_NAME=security-logs-bucket
# S3_PREFIX=cloudtrail/
# FETCH_INTERVAL=300
# RUN_MODE=continuous

# Example for ALB monitoring:
# AWS_SERVICE=alb
# S3_BUCKET_NAME=alb-logs-bucket
# S3_PREFIX=alb-logs/
# FETCH_INTERVAL=60
# RUN_MODE=continuous

# Example for VPC Flow Logs:
# AWS_SERVICE=vpcflow
# S3_BUCKET_NAME=vpc-logs-bucket
# S3_PREFIX=vpc-logs/
# FETCH_INTERVAL=600
# RUN_MODE=continuous 